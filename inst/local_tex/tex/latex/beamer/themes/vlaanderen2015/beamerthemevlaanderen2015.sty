% Copyright 2014 by Thierry Onkelinx
%
% This file may be distributed and/or modified
%
% 1. under the LaTeX Project Public License and/or
% 2. under the GNU Public License.
%
% See the file doc/licenses/LICENSE for more details.
\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{beamerthemevlaanderen2015}

\setbeamertemplate{background}{\includegraphics[width=\paperwidth,height=\paperheight,keepaspectratio]{slide.pdf}}

\def\lang#1{\def\@lang{#1}}
\lang{english}

\def\coverhorizontal#1{\def\@coverhorizontal{#1}}
\coverhorizontal{TRUE}

\def\cover#1{\def\@cover{#1}}
\cover{fietskader.jpg}

\def\coveroffset#1{\def\@coveroffset{#1}}
\coveroffset{0mm}

\def\coverhoffset#1{\def\@coverhoffset{#1}}
\coverhoffset{0mm}

\def\website#1{\def\@website{#1}}
\website{}

\definecolor{main.colour}{RGB}{255, 235, 0}
\definecolor{frametitle.colour}{RGB}{60, 61, 60}

\RequirePackage[absolute, overlay]{textpos}
\setlength{\TPHorizModule}{1mm}
\setlength{\TPVertModule}{\TPHorizModule}
\textblockorigin{0mm}{0mm}

\RequirePackage{pgf}

\RequirePackage{etoolbox}

\newcommand{\readcover}[2]{%
  \edef\coverhorizontal{{#1}}%
  \expandafter\ifstrequal\coverhorizontal{TRUE}{
    \pgfdeclareimage[width = 124.5mm, interpolate = true]{afbeelding}{#2}
  }{
    \pgfdeclareimage[height = 96mm, interpolate = true]{afbeelding}{#2}
  }%
}

\RequirePackage{inboimage_2015}

% define font sizes
\newcommand{\titlefontsize}{\fontsize{28pt}{33.6pt}\selectfont}
\newcommand{\subtitlefontsize}{\fontsize{21pt}{25.2pt}\selectfont}
\newcommand{\authorfontsize}{\fontsize{10pt}{12pt}\selectfont}
\newcommand{\datefontsize}{\fontsize{8pt}{9.6pt}\selectfont}
\newcommand{\institutefontsize}{\fontsize{8pt}{9.6pt}\selectfont}
\newcommand{\websitefontsize}{\fontsize{7pt}{8pt}\selectfont}

% defines fonts
\RequirePackage{ifxetex}

\ifxetex
  \RequirePackage[no-math]{fontspec}
  \setmainfont[Ligatures=TeX]{Calibri}
  \setmonofont{Courier New}
\else
  \RequirePackage[T1]{fontenc}
  \RequirePackage[utf8]{inputenc}
  \RequirePackage{lmodern}
\fi
\usefonttheme{serif}

\frenchspacing

% set fonts for different elements

\setbeamercolor{title}{fg=white}
\setbeamerfont{title}{size = \titlefontsize, series = \bfseries}

\setbeamercolor{subtitle}{fg=white}
\setbeamerfont{subtitle}{size = \subtitlefontsize, series = \bfseries}

\setbeamerfont{frametitle}{series = \bfseries, size = \large}
\setbeamercolor{frametitle}{bg=,fg=frametitle.colour}

\setbeamercolor{author}{fg=white}
\setbeamerfont{author}{size = \authorfontsize}

\setbeamercolor{date}{fg=white}
\setbeamerfont{date}{size = \datefontsize}

\setbeamercolor{institute}{fg=white}
\setbeamerfont{institute}{size = \institutefontsize}

\setbeamerfont{sidebar}{size = \websitefontsize, series = \bfseries}
\setbeamercolor{sidebar}{fg = frametitle.colour, bg = white}

% define title page
\setbeamertemplate{title page}{
  \begin{textblock}{124.5}(3.5, 0)
    \readcover{\@coverhorizontal}{\@cover}
    \begin{pgftranslate}{\pgfpoint{\@coverhoffset}{\@coveroffset}}
      \pgfuseimage{afbeelding}
    \end{pgftranslate}
  \end{textblock}

  \begin{textblock}{3.5}(0, 0)
    \begin{pgfpicture}{0cm}{0cm}{3.5mm}{96mm}
      \color{white}
      \pgfrect[fill]{\pgfpoint{0mm}{0mm}}{\pgfpoint{3.5mm}{96mm}}
    \end{pgfpicture}
  \end{textblock}

  \begin{textblock}{2.9}(1.2, 78)
    {\usebeamerfont{sidebar}\usebeamercolor[fg]{sidebar}\rotatebox{90}{\@website}}
  \end{textblock}

  \begin{textblock}{84}(18.1, 6)
    \begin{minipage}[b][50mm][b]{78mm}
      \noindent
      \raggedright
      {\usebeamerfont{title}\usebeamercolor[fg]{title}\inserttitle}\\
      {\usebeamerfont{subtitle}\usebeamercolor[fg]{subtitle}\insertsubtitle}
    \end{minipage}
  \end{textblock}

  \begin{textblock}{104}(18.1, 58.1)
     {\usebeamerfont{date}\usebeamercolor[fg]{date}\insertdate}~\\
     \vspace{5mm}
     \raggedright {\usebeamerfont{author}\usebeamercolor[fg]{author}\insertauthor}

     {\usebeamerfont{institute}\usebeamercolor[fg]{institute}\insertinstitute}
  \end{textblock}

  \begin{textblock}{14}(109.9, -.2)
    \begin{center}
      \includegraphics[width = 12.7mm]{vlaanderen_en_verticaal.eps}
    \end{center}
  \end{textblock}
}

\setbeamertemplate{frametitle}{
  \vspace{3mm}\raggedright {\usebeamerfont{frame title}\usebeamercolor[fg]{frame title}\insertframetitle}

  {\small \insertframesubtitle}
}

\setbeamertemplate{sidebar left}{
  \vspace{81.9mm}
  \hspace{9.2mm}
  \includegraphics[width = 24.5mm]{vlaanderen_en_naakt}

  \begin{textblock}{4}(0, 0)
    \begin{pgfpicture}{0cm}{0cm}{3.5mm}{96mm}
      \usebeamercolor[bg]{sidebar}
      \pgfrect[fill]{\pgfpoint{0mm}{0mm}}{\pgfpoint{4mm}{96mm}}
    \end{pgfpicture}
  \end{textblock}

  \begin{textblock}{2.9}(1.2, 78)
    {\usebeamerfont{sidebar}\usebeamercolor[fg]{sidebar}\rotatebox{90}{\@website}}
  \end{textblock}

  \begin{textblock}{4}(4, 0)
    \begin{pgfpicture}{0cm}{0cm}{3.5mm}{96mm}
      \color{main.colour}
      \pgfrect[fill]{\pgfpoint{0mm}{0mm}}{\pgfpoint{4.1mm}{96mm}}
    \end{pgfpicture}
  \end{textblock}
}
